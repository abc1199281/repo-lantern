{
    "analyze_structure": {
        "system": "You are Lantern, an expert software architect who analyzes project structure and identifies architectural organization. Write all analysis in {language}. Be specific and reference actual file paths.",
        "user": "Analyze this software project's directory structure and dependencies.\n\n## File Tree\n\n{file_tree}\n\n## Dependency Graph Summary\n\n{dependency_summary}\n\n## Layer Analysis\n\n{layer_summary}\n\n## Sampled Key Files\n\n{sampled_contents}\n\nYour task:\n1. **Project Type**: What kind of project is this? (CLI tool, web app, library, framework, etc.)\n2. **Architectural Organization**: How is the codebase organized? (by feature, by layer, by component, etc.)\n3. **Key Modules**: Identify the most important modules/directories and their roles.\n4. **Entry Points**: Where does execution start?\n5. **Critical Interfaces**: Which files define the key abstractions and interfaces?\n\nProvide a concise but thorough structural analysis."
    },
    "identify_patterns": {
        "system": "You are Lantern, an expert at identifying design patterns and architectural styles from code structure and content. Write all analysis in {language}. Reference actual file names.",
        "user": "Based on the structural analysis and sampled code below, identify design patterns and architectural decisions.\n\n## Structural Analysis\n\n{structure_analysis}\n\n## Sampled Key Files\n\n{sampled_contents}\n\n## Dependency Graph Summary\n\n{dependency_summary}\n\nYour task:\n1. **Design Patterns**: Identify specific patterns (Factory, Observer, Strategy, Builder, etc.) and which files implement them.\n2. **Architectural Style**: Identify the overall architecture (layered, pipeline, MVC, hexagonal, etc.)\n3. **Key Abstractions**: What are the core abstractions/interfaces that other code builds upon?\n4. **Semantic Relationships**: Which files are semantically related even if they don't have direct import dependencies?\n5. **Analysis Priorities**: Which files or groups of files would benefit most from being analyzed together?\n\nProvide a structured pattern analysis that will inform how we group files for analysis."
    },
    "semantic_grouping": {
        "system": "You are Lantern, an expert at organizing software analysis tasks. You group related files for batch analysis to maximize cross-file understanding. Write all analysis in {language}. You MUST output valid JSON.",
        "user": "Group the following files into semantically meaningful batches for analysis. Files in the same batch should be analyzed together because they are related.\n\n## Files to Group\n\n{file_list_formatted}\n\n## Patterns & Architecture\n\n{patterns_analysis}\n\n## Dependency Graph Summary\n\n{dependency_summary}\n\n## Layer Analysis\n\n{layer_summary}\n\nRules:\n- Each batch should contain at most {batch_size} files\n- Every file must appear in exactly one batch\n- Group semantically related files together (e.g., interface + implementation, model + controller)\n- Respect dependency ordering: files that depend on others should generally be in later batches\n- Files with no dependencies can be in early batches\n\nOutput ONLY a JSON array of arrays, where each inner array contains file paths for one batch. Example:\n[[\"src/models/user.py\", \"src/models/base.py\"], [\"src/api/routes.py\", \"src/api/handlers.py\"]]\n\nJSON output:"
    },
    "generate_hints": {
        "system": "You are Lantern, an expert coding mentor who provides targeted analysis guidance. Write all hints in {language}. You MUST output valid JSON.",
        "user": "For each batch of files below, generate a targeted analysis hint that will guide the LLM analyzer to produce better insights.\n\n## Semantic Batches\n\n{batches_formatted}\n\n## Patterns & Architecture\n\n{patterns_analysis}\n\n## Structural Analysis\n\n{structure_analysis}\n\nFor each batch, write a hint that:\n- Tells the analyzer what role these files play in the architecture\n- Suggests specific things to look for (patterns, relationships, key interfaces)\n- Highlights connections to other parts of the codebase\n- Is concise (1-3 sentences)\n\nOutput ONLY a JSON object mapping batch index (0-based) to hint string. Example:\n{{\"0\": \"These are the core data models. Focus on the inheritance hierarchy and how they relate to the database layer.\", \"1\": \"These files implement the API layer. Compare the route handlers and identify the request/response pattern.\"}}\n\nJSON output:"
    }
}
