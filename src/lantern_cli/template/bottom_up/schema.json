{
    "title": "Lantern Bottom-up Batch Output",
    "description": "Structured analysis for a single source file. Each field maps to Lantern's bottom-up template.",
    "type": "object",
    "properties": {
        "summary": {
            "type": "string",
            "description": "Concise overview of what the file or code block does (4000 characters max).",
            "maxLength": 4000
        },
        "key_insights": {
            "type": "array",
            "description": "Key takeaways from the file that explain important patterns, constraints, or behaviors.",
            "items": {
                "type": "string",
                "maxLength": 400
            },
            "maxItems": 8
        },
        "functions": {
            "type": "array",
            "description": "Important functions or procedures in the file, each with a short note about its purpose.",
            "items": {
                "type": "string",
                "maxLength": 400
            },
            "maxItems": 5
        },
        "classes": {
            "type": "array",
            "description": "Classes or types declared in this file plus a brief summary of their responsibility.",
            "items": {
                "type": "string",
                "maxLength": 400
            },
            "maxItems": 5
        },
        "flow": {
            "type": "string",
            "description": "Describe the most important control or data flow that involves this file (2000 characters).",
            "maxLength": 2000
        },
        "references": {
            "type": "array",
            "description": "Paths, line ranges, or components referenced when summarizing this file.",
            "items": {
                "type": "string",
                "maxLength": 200
            },
            "maxItems": 5
        },
        "language": {
            "type": "string",
            "description": "Target language code for this summary (e.g., 'en', 'zh-TW').",
            "pattern": "^[a-z]{2}(-[A-Z]{2})?$"
        }
    },
    "required": ["summary", "key_insights"]
}
