# Lantern

> **åœ¨é»‘æš—çš„ç¨‹å¼ç¢¼æ£®æ—ä¸­ï¼Œç…§äº®ä½ çš„æ–¹å‘ã€‚**

[English](README.md) | [ç¹é«”ä¸­æ–‡]

![Lantern Hero Image](assets/lantern.jpg)

**Lantern æ˜¯ä½ çš„ CLI å°å¸«ï¼Œå°‡è¤‡é›œçš„ Repository è½‰åŒ–ç‚ºå¾ªåºæ¼¸é€²çš„æ•˜äº‹æµç¨‹ã€‚**

é€é AI å¼•å°çš„æ¶æ§‹æƒæã€è¦åŠƒå¥½çš„å­¸ç¿’è·¯å¾‘ä»¥åŠäººé¡å¯è®€çš„æŒ‡å—ï¼Œæ›´å¿«é€Ÿåœ°ç†è§£ç¨‹å¼ç¢¼åº«ã€‚

**èªªä½ çš„èªè¨€**ï¼šé‚è¼¯å·²ç¶“å¤ è¤‡é›œäº†ã€‚Lantern ä½¿ç”¨ä½ çš„æ¯èªï¼ˆä¸­æ–‡ã€æ—¥æ–‡ã€è¥¿ç­ç‰™æ–‡ç­‰ï¼‰è§£é‡‹ç¨‹å¼ç¢¼ï¼ŒåŒæ™‚ä¿æŒæŠ€è¡“è¡“èªçš„ç²¾ç¢ºæ€§ã€‚

### âœ¨ äº®é»

| | |
| :--- | :--- |
| ğŸ§  **èªçŸ¥è² æ“”æ¸›è¼•** | åŸºæ–¼å¿ƒç†å­¸çš„å€å¡ŠåŒ–è¨­è¨ˆï¼ˆç±³å‹’å®šå¾‹ï¼‰ï¼Œå°‡åˆ†ææ‹†è§£ç‚ºå¯æ¶ˆåŒ–çš„å°æ‰¹æ¬¡ |
| ğŸŒ **æ¯èªè¼¸å‡º** | æŠ€è¡“æ–‡æª”ä»¥ä½ çš„æ¯èªå‘ˆç¾â€”â€”ä¸­æ–‡ã€æ—¥æ–‡ã€è¥¿ç­ç‰™æ–‡ç­‰ |
| ğŸ“Š **è‡ªå‹•ç”Ÿæˆåœ–è¡¨** | ç‚ºæ¯å€‹æ¨¡çµ„è‡ªå‹•ç”Ÿæˆ Mermaid æµç¨‹åœ– + Sequence Diagram |
| ğŸ’¡ **æ¦‚å¿µèƒå–** | æ ¸å¿ƒèªçŸ¥æ¨¡å‹ï¼šèªè­‰æµç¨‹ã€å¿«å–ç­–ç•¥ã€é‡è©¦æ©Ÿåˆ¶ |
| ğŸ”’ **æœ¬åœ°å„ªå…ˆã€éš±ç§å¯æ§** | æ”¯æ´ Ollama 100% æœ¬åœ°åˆ†æâ€”â€”é©åˆä¼æ¥­èˆ‡æ•æ„Ÿç¨‹å¼ç¢¼åº« |

---

# ç‚ºä»€éº¼éœ€è¦ Lantern

ç†è§£ä¸€å€‹é™Œç”Ÿçš„ç¨‹å¼ç¢¼åº«éå¸¸å›°é›£ã€‚ä½ é€šå¸¸æœƒé‡åˆ°ï¼š
* ä¸çŸ¥é“è©²å¾å“ªå€‹æª”æ¡ˆé–‹å§‹çœ‹èµ·
* æ–‡ä»¶éæ™‚æˆ–æ ¹æœ¬ä¸å­˜åœ¨
* éš±è—çš„ç³»çµ±æ¶æ§‹ä¾è³´é—œä¿‚
* éœ€è¦é–±è®€æ•¸åå€‹æª”æ¡ˆæ‰èƒ½ç†è§£ä¸€å€‹æ ¸å¿ƒæ¦‚å¿µ

**ç¾ä»£ç¨‹å¼ç¢¼åº«ä¸­å¸¸æœ‰ AI ç”Ÿæˆçš„ç¨‹å¼ç¢¼èƒ½é‹ä½œå»ç¼ºä¹æ–‡æª”**â€”â€”ä½¿ç†è§£æ›´å›°é›£ã€‚

å¤§å¤šæ•¸ AI å·¥å…·å¹«åŠ©ä½ *å¯«*æˆ–*é‡æ§‹*ç¨‹å¼ç¢¼ã€‚**Lantern çš„ç›®æ¨™æˆªç„¶ä¸åŒï¼š**
> Lantern å¹«åŠ©ä½ ã€Œç†è§£ã€ç¨‹å¼ç¢¼â€”â€”ç„¡è«–æ˜¯äººå¯«çš„é‚„æ˜¯ AI ç”Ÿæˆçš„ã€‚

---

# æ‡‰ç”¨å ´æ™¯ (Use Cases)

| å ´æ™¯ | Lantern å¦‚ä½•å¹«åŠ© |
| :--- | :--- |
| ğŸ‘¤ **æ–°äºº Onboarding** | å¿«é€Ÿç†è§£è¤‡é›œéºç•™ç³»çµ±ï¼Œç„¡éœ€ä¾è³´ã€Œéƒ¨è½çŸ¥è­˜ã€ |
| ğŸ”§ **é‡æ§‹å‰åˆ†æ** | è©•ä¼°ä¿®æ”¹å½±éŸ¿ç¯„åœï¼Œé™ä½é¢¨éšª |
| âš ï¸ **æŠ€è¡“å‚µå‹™è©•ä¼°** | è­˜åˆ¥é«˜é¢¨éšªæ¨¡çµ„èˆ‡éš±è—ä¾è³´ |
| ğŸ—ï¸ **æ¶æ§‹æ±ºç­–è¼”åŠ©** | é€éæ¸…æ™°çš„ç³»çµ±è¦–é‡åšå‡ºæ›´å¥½çš„è¨­è¨ˆé¸æ“‡ |
| ğŸ” **Code Review æº–å‚™** | åœ¨å¯©æŸ¥ PR å‰å…ˆç†è§£é™Œç”Ÿç¨‹å¼ç¢¼ |

---

# è¨­è¨ˆåŸå‰‡èˆ‡æ ¸å¿ƒç‰¹è‰²

### ğŸ§  å¿ƒç†å­¸å°å‘è¨­è¨ˆ
**å°ˆç‚ºäººé¡ç†è§£è€Œè¨­è¨ˆ**ï¼Œæ¡ç”¨å¿ƒç†å­¸åŸå‰‡ï¼š
- **å€å¡ŠåŒ–**ï¼ˆç±³å‹’å®šå¾‹ï¼‰ï¼šæ¯å€‹åˆ†ææ‰¹æ¬¡é™åˆ¶åœ¨ç´„ 3 å€‹ç›¸é—œæª”æ¡ˆï¼Œé˜²æ­¢èªçŸ¥è¶…è¼‰
- **é·¹æ¶æ•ˆæ‡‰**ï¼ˆScaffoldingï¼‰ï¼šå…ˆç”Ÿæˆè¨ˆç•«ä¾›äººå·¥å¯©æŸ¥ï¼Œå¾ªåºæ¼¸é€²åœ°å»ºç«‹ç†è§£
- **äººé¡å„ªå…ˆè¼¸å‡º**ï¼šè§£é‡‹ã€Œç‚ºä»€éº¼ã€èˆ‡ã€Œå¦‚ä½•é‹ä½œã€ï¼Œå„ªå…ˆè€ƒé‡äººé¡é–±è®€é«”é©—

### ğŸ”„ é›™å‘åˆ†æè¦–è§’
**Bottom-up**ï¼ˆé€æª”ç´°ç¯€ï¼‰+ **Top-down**ï¼ˆæ¶æ§‹ç¸½è¦½ï¼‰= å¾ä»»ä½•è§’åº¦å®Œæ•´ç†è§£ã€‚

### ğŸ”Œ å½ˆæ€§å¾Œç«¯
å¯é¸æ“‡æœ¬åœ°éš±ç§ï¼ˆOllamaï¼‰æˆ–é›²ç«¯æ•ˆèƒ½ï¼ˆOpenRouterï¼‰ã€‚æ›´æ›å¾Œç«¯ç„¡éœ€æ”¹è®Šå·¥ä½œæµç¨‹ã€‚

### âœï¸ äººæ©Ÿå”ä½œ
åœ¨åŸ·è¡Œå‰å¯©æŸ¥ä¸¦ç·¨è¼¯ `lantern_plan.md`ã€‚ä½ æŒæ§åˆ†æçš„å…§å®¹èˆ‡æ–¹å¼ã€‚

# Lantern çš„åŠŸèƒ½

**ä¸€æ¬¡æŒ‡ä»¤ã€‚å®Œæ•´æ–‡æª”ã€‚**

```bash
lantern run
```

Lantern åˆ†æä½ çš„ Repository ä¸¦ç”¢ç”Ÿä¸€å€‹ **å®Œæ•´çš„æ–‡æª”åº«**ï¼š

![Lantern è¼¸å…¥èˆ‡è¼¸å‡º](assets/input_output.png)

### è¼¸å…¥
```
path to repo
```

### è¼¸å‡º
```
.lantern/output/
â”œâ”€â”€ en/
â”‚   â”œâ”€â”€ top_down/                    # ğŸ“– é«˜å±¤æ¬¡æŒ‡å—
â”‚   â”‚   â”œâ”€â”€ OVERVIEW.md             # å°ˆæ¡ˆé¡˜æ™¯èˆ‡ç¯„åœ
â”‚   â”‚   â”œâ”€â”€ ARCHITECTURE.md         # ç³»çµ±è¨­è¨ˆ + Mermaid ä¾è³´åœ–
â”‚   â”‚   â”œâ”€â”€ CONCEPTS.md             # æ ¸å¿ƒæ¦‚å¿µï¼ˆèªè­‰æµç¨‹ã€å¿«å–ã€é‡è©¦ï¼‰
â”‚   â”‚   â””â”€â”€ GETTING_STARTED.md      # æ–°æ‰‹ä¸Šæ‰‹æŒ‡å— + Mermaid Sequence Diagram
â”‚   â”‚
â”‚   â””â”€â”€ bottom_up/                   # ğŸ“ é€æª”åˆ†æ
â”‚       â””â”€â”€ src/                     # é¡åƒä½ çš„ repo çµæ§‹
â”‚           â”œâ”€â”€ kernel/
â”‚           â”‚   â”œâ”€â”€ scheduler.py.md  # è©³ç´°æ‹†è§£
â”‚           â”‚   â””â”€â”€ events.py.md
â”‚           â””â”€â”€ api/
â”‚               â””â”€â”€ routes.py.md
â”‚
â””â”€â”€ zh-TW/                           # ğŸŒ æ¯èªç‰ˆæœ¬
    â””â”€â”€ (åŒä¸Šçµæ§‹)
```

### å¦‚ä½•ç¢ºä¿å“è³ª

Lantern å…§éƒ¨ä½¿ç”¨ **æ‰¹æ¬¡åˆ†æ** ä¾†æ§åˆ¶å“è³ªï¼š
- æª”æ¡ˆä»¥å°æ‰¹æ¬¡åˆ†æï¼ˆ1-3 å€‹ç›¸é—œæª”æ¡ˆï¼‰
- æ¯å€‹æ‰¹æ¬¡å»ºç«‹åœ¨å‰ä¸€æ‰¹æ¬¡çš„è„ˆçµ¡ä¹‹ä¸Š
- ç¢ºä¿ **å¯è¿½æº¯æ€§** èˆ‡ **ä¸€è‡´çš„æ¨ç†**

ä½ ä¸éœ€è¦ç®¡ç†é€™äº›â€”â€”åªè¦åŸ·è¡Œ `lantern run` è®“å®ƒé‹ä½œã€‚

---

# è¦–è¦ºåŒ–æµç¨‹é‡å»º

Lantern æœƒè‡ªå‹•ç‚ºæ¯å€‹åˆ†æçš„æª”æ¡ˆç”Ÿæˆ **Mermaid åœ–è¡¨**ï¼š

### æ¶æ§‹åœ–
åœ¨ `ARCHITECTURE.md` ä¸­é¡¯ç¤ºæ¨¡çµ„ä¾è³´èˆ‡é—œä¿‚ï¼š

```mermaid
graph LR
    API --> Auth
    API --> Models
    Auth --> Database
    Models --> Database
```

**Sequence Diagram èˆ‡é€æª”æµç¨‹åœ–**ï¼šLantern ä¹Ÿæœƒç”Ÿæˆè«‹æ±‚/å›æ‡‰çš„ Sequence Diagram èˆ‡é¡¯ç¤ºå…§éƒ¨é‚è¼¯çš„é€æª”æµç¨‹åœ–ã€‚

**ç„¡éœ€æ‰‹å‹•å·¥ä½œ**â€”â€”åœ–è¡¨é€éåˆ†æç¨‹å¼ç¢¼çµæ§‹è‡ªå‹•ç”Ÿæˆã€‚

---

# å¿«é€Ÿä¸Šæ‰‹

## å‰ç½®éœ€æ±‚

Lantern æ”¯æ´å¤šç¨®å¾Œç«¯é¸é …ã€‚è©³ç´°è¨­å®šèªªæ˜è«‹è¦‹[å¾Œç«¯è¨­å®š](#å¾Œç«¯è¨­å®š)ï¼š

- **OpenAI**ï¼ˆæ¨è–¦ï¼‰- æˆæœ¬æ•ˆç›Šé«˜ã€é©åˆç”Ÿç”¢ç’°å¢ƒ
- **Ollama**ï¼ˆå…è²»ä¸”éš±ç§ï¼‰- åœ¨æœ¬åœ°åŸ·è¡Œï¼Œç„¡ API å‘¼å«
- **OpenRouter** - å­˜å–å¤šå€‹æä¾›å•†ï¼ˆClaudeã€Gemini ç­‰ï¼‰
- **CLI Tool** - åˆ©ç”¨ä»£ç†èƒ½åŠ›ï¼ˆæª”æ¡ˆå·¥å…·ã€ç¨‹å¼ç¢¼åŸ·è¡Œï¼‰

## å®‰è£

```bash
pip install repo-lantern
```

## ç°¡æ˜“æ¨¡å¼ï¼ˆæ¨è–¦ï¼‰

```bash
# åœ¨ç•¶å‰ç›®éŒ„åŸ·è¡Œï¼ˆè¼¸å‡ºè‡³ .lantern/ï¼‰
lantern run

# æŒ‡å®šè¼¸å…¥èˆ‡è¼¸å‡º
lantern run --repo ~/projects/my-app --output ~/docs/my-app-docs

# ä½¿ç”¨ç‰¹å®šèªè¨€
lantern run --lang zh-TW  # ç¹é«”ä¸­æ–‡
```

Lantern æœƒåœ¨é–‹å§‹å‰é¡¯ç¤º**æˆæœ¬ä¼°ç®—**ã€‚é è¨­å¾Œç«¯ç‚º OpenAIï¼Œä½†ä½ å¯ä»¥åœ¨ `.lantern/lantern.toml` ä¸­è¨­å®šï¼š

```toml
[backend]
type = "openai"              # æˆ– "ollama"ã€"openrouter"
openai_model = "gpt-4o-mini" # ç”Ÿç”¢ç’°å¢ƒå¿«é€Ÿä¸”ä¾¿å®œ
# openai_model = "gpt-4o"    # æ›´é«˜å“è³ªé¸é …
```

## é€²éšæ¨¡å¼

è‹¥éœ€è¦å¯©æŸ¥åˆ†æè¨ˆç•«ï¼š

```bash
# Step 1: åˆå§‹åŒ–
lantern init --repo /path/to/repo

# Step 2: ç”Ÿæˆè¨ˆç•«ï¼ˆå¯©æŸ¥ lantern_plan.mdï¼‰
lantern plan

# Step 3: åŸ·è¡Œåˆ†æ
lantern run
```

# è¨­å®š

## èªè¨€è¨­å®š

ä½ å¯ä»¥è¨­å®šåå¥½çš„è¼¸å‡ºèªè¨€ï¼ˆå¦‚ç¹é«”ä¸­æ–‡ã€æ—¥æ–‡ï¼‰ï¼Œé€²ä¸€æ­¥é™ä½èªçŸ¥é–€æª»ã€‚

**æ–¹æ³• Aï¼šå‘½ä»¤åˆ—åƒæ•¸**
```bash
lantern run --lang zh-TW
```

---

# å¾Œç«¯è¨­å®š

Lantern æ”¯æ´å¤šç¨® LLM å¾Œç«¯ï¼Œè¨­å®šç°¡å–®ï¼š

### OpenAIï¼ˆç”Ÿç”¢ç’°å¢ƒæ¨è–¦ï¼‰â­
```toml
# .lantern/lantern.toml
[backend]
type = "openai"
openai_model = "gpt-4o-mini"  # å¿«é€Ÿä¸”ä¾¿å®œ
# openai_model = "gpt-4o"     # æ›´é«˜å“è³ª
```

è¨­å®šä½ çš„ API é‡‘é‘°ï¼š
```bash
export OPENAI_API_KEY="sk-..."
```

**å®šåƒ¹**ï¼ˆ2025 å¹´ï¼‰ï¼š
- gpt-4o-miniï¼š$0.15/1M è¼¸å…¥ï¼Œ$0.60/1M è¼¸å‡º
- gpt-4oï¼š$2.50/1M è¼¸å…¥ï¼Œ$10/1M è¼¸å‡º

### Ollamaï¼ˆæœ¬åœ°æ¨¡å‹ï¼‰
```toml
[backend]
type = "ollama"
ollama_model = "qwen2.5:14b"  # æˆ– llama3ã€mistral ç­‰
```

### OpenRouterï¼ˆå¤šæ¨¡å‹å­˜å–ï¼‰
```toml
[backend]
type = "openrouter"
openrouter_model = "openai/gpt-4o-mini"  # æˆ– anthropic/claude-sonnet-4 ç­‰
```

è¨­å®šä½ çš„ API é‡‘é‘°ï¼š
```bash
export OPENROUTER_API_KEY="sk-or-v1-..."
```

### CLI Toolï¼ˆä»£ç†å‹å·¥ä½œæµï¼‰ğŸ¤–
```toml
[backend]
type = "cli"
cli_command = "codex exec"  # æˆ– "llm -m gpt-4o-mini"ã€"claude" ç­‰
cli_model_name = "cli"
```

**é‹ä½œæ–¹å¼**ï¼š
- Lantern åµæ¸¬åˆ° CLI å¾Œç«¯æ™‚ï¼Œè‡ªå‹•åˆ‡æ›åˆ°**ä»£ç†å‹å·¥ä½œæµ**
- æç¤ºè©æŒ‡ç¤ºä»£ç†ç›´æ¥ä½¿ç”¨æª”æ¡ˆå·¥å…·ç·¨å¯« Markdown æª”æ¡ˆ
- ä»£ç†åˆ©ç”¨å…¶åŸç”Ÿèƒ½åŠ›ï¼ˆç¨‹å¼ç¢¼åŸ·è¡Œã€æª”æ¡ˆæ“ä½œç­‰ï¼‰
- ç„¡éœ€ JSON è§£æâ€”â€”ä»£ç†ç›´æ¥ç·¨å¯«æ–‡æª”æª”æ¡ˆ

**æ”¯æ´çš„ CLI å·¥å…·**ï¼š
- `codex exec` - OpenAI Codex æ­é…ä»£ç†èƒ½åŠ›
- `llm -m <model>` - Simon Willison çš„ LLM å·¥å…·
- `claude` - Anthropic Claude CLI
- ä»»ä½•æ”¯æ´ stdin èˆ‡ stdout çš„è‡ªè¨‚ CLI

**ç¯„ä¾‹å·¥ä½œæµ**ï¼š
```bash
# å®‰è£ CLI å·¥å…·ï¼ˆç¯„ä¾‹ï¼šllmï¼‰
pip install llm

# è¨­å®š Lantern ä½¿ç”¨å®ƒ
echo '[backend]
type = "cli"
cli_command = "llm -m gpt-4o-mini"
cli_model_name = "gpt-4o-mini"' > .lantern/lantern.toml

# åŸ·è¡Œåˆ†æ
lantern run
```

### æˆæœ¬ä¼°ç®—
åŸ·è¡Œå‰ï¼ŒLantern æœƒå–å¾—**å³æ™‚å®šåƒ¹**ä¸¦é¡¯ç¤ºï¼š
- é ä¼°è¼¸å…¥/è¼¸å‡º token
- é è¨ˆæˆæœ¬ï¼ˆç¾å…ƒï¼‰
- ç¢ºèªæç¤º

æœ¬åœ°æ¨¡å‹ï¼ˆOllamaï¼‰é¡¯ç¤º $0.00 æˆæœ¬ã€‚

---

# ç™¼å±•è—åœ– (Roadmap)

- [ ] **Execution Trace Mode**ï¼šé€é unit test æ”¶é›† call graphï¼Œå¯¦ç¾å‹•æ…‹åˆ†æã€‚
- [ ] **è·¨æ‰¹æ¬¡æ¨è«–**ï¼šåŠ å¼·è·¨æ‰¹æ¬¡é‚Šç•Œçš„é‚è¼¯é—œè¯åˆ†æã€‚
- [ ] **å¤šèªè¨€éœæ…‹åˆ†ææ”¯æ´**ï¼šæ“´å±•è‡³ Go, Rust, èˆ‡ Javaã€‚
- [ ] **VSCode å»¶ä¼¸æ’ä»¶**ï¼šæ•´åˆé€²åº¦è¿½è¹¤èˆ‡å¯è¦–åŒ–ã€‚

---

# åƒèˆ‡è²¢ç»

æ­¡è¿æäº¤ PRï¼å¹«åŠ©æˆ‘å€‘æ‰“é€ ç†è§£ç¨‹å¼ç¢¼çš„çµ‚æ¥µå·¥å…·ã€‚

---

# æˆæ¬Šå”å®š

MIT
